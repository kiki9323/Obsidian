# HTTP
## HTTP 정의 
HTML과 같은 하이퍼미디어 문서를 전송하고, 리소스를 가져오게 하는 **애플리케이션 계증 프로토콜** (인터넷 통신 규약)  

`웹 브라우저`와 `웹 서버`간의 **통신을 위해 설계**되었지만 다른 목적으로도 사용 가능하다.  
HTTP는 클라이언트가 요청을 하기 위해 연결을 연 다음 다음 응답을 받을 때까지 대기하는 전통적인 [클라이언트-서버 모델](https://en.wikipedia.org/wiki/Client%E2%80%93server_model) 을 따른다.  

HTTP는 [무상태 프로토콜]()이며, 서버가 두 요청 간에 어떠한 데이터(상태)도 유지하지 않는다.  

> * 클라이언트-서버 모델?
> 
> 서버라고 하는 리소스 또는 서비스 제공자와 클라이언트라고 하는 서비스 요청자 간에 작업이나 작업 부하를 분할 하는 분산 애플리케이션 구조이다.  

---
## Index
[HTTP 개요](https://developer.mozilla.org/ko/docs/Web/HTTP/Overview) 
* 클라이언트-서버 프로토콜의 기본 기능을 통해 HTTP로 할 수 있는 것과 의도된 용도를 알 수 있다.  

[HTTP 캐시](https://developer.mozilla.org/ko/docs/Web/HTTP/Caching) 
* HTTP 캐시, 캐싱은 빠른 웹 사이트를 위해 중요하다.   

[HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies) 
* 쿠키가 동작하는 방식은 [RFC 6265](https://datatracker.ietf.org/doc/html/rfc6265)에서 정의. 
* HTTP  요청을 서버에 넘겨줄 때...  
	1. 서버는 응답과 함께 `Set-Cookie` HTTP 헤더를 돌려줍니다. 
	2. 그 다음에 클라이언트는 모든 요청과 함께 쿠키의 값을 `Cookie` 요청 헤더의 형태로 동일한 서버로 넘겨줍니다. 
	3. 쿠키는 특정 날짜에 만료되도록 설정하거나, 특정 도메인 및 경로에 제한되도록 설정할수도 있습니다.  

[교차 출처 리소스 공유(CORS)](https://developer.mozilla.org/ko/docs/Web/HTTP/CORS)   
* **교차 사이트 HTTP 요청**은 요청을 생성한 리소스의 도메인과 **다른 도메인**의 리소스에 대한 HTTP 요청이다.   
* 예를 들면, 도메인 A(`http://domaina.example/`)의 HTML 페이지가 `img` 요소를 통해 도메인 B(`http://domainb.foo/image.jpg`)의 이미지에 대한 요청을 생성하는 것입니다. 오늘날의 웹 페이지가 CSS 스타일시트, 이미지, 스크립트 등을 포함하는 교차-사이트 리소스을 로드하는 것을 아주 흔하게 볼 수 있습니다. CORS를 통해 웹 개발자는 그들의 사이트가 교차-사이트 요청에 대해 어떻게 반응할지 제어할 수 있습니다.

---

## HTTP 개요
HTTP는 HTML 문서와 같은 **리소스**들을 가져올 수 있도록 해주는 프로토콜  
* 웹에서 이루어지는 모든 데이터 교환의 기초
* 클라이언트-서버 프로토콜
#### 클라이언트-서버 프로토콜
수신자 측에 의해 요청이 초기화되는 프로토콜을 의미한다.  

클라이언트와 서버들은 **각각의 개별적인 메시지 교환**에 의해 통신한다.  
1. **requests** (요청) : 보통 브라우저인 클라이언트에 의해 전송되는 메시지
2. **responses** (응답) : 이 요청에 대해 서버에서 전송되는 메시지

![[Pasted image 20231009120234.png]]

### 1. 클라이언트: 사용자 에이전트
사용자 에이전트는 사용자를 대신하여 동작하는 모든 도구들을 말한다.  
이 역할은 주로 브라우저에서 수행됨.

브라우저는 항상 **요청**을 보내는 개체이다.  

웹 페이지를 표시하기 위해, 
1. 브라우저는 `HTML` 문서를 가져오기 위한 요청을 전송한 뒤, 
2. 파일을 구문 분석하여 실행해야 할 `스크립트`와 페이지 내 포함된 하위 리소스들(보통 이미지와 비디오)을 잘 표시하기 위해 레이아웃 정보(`CSS`)에 대응하는 추가적인 요청을 가져온다.
그리고 브라우저는 완전한 문서인 웹 페이지를 표시하기 위해 그런 리소스들을 혼합한다.  

### 2. 웹 서버
클라이언트에 의한 요청에 대한 문서를 **제공**한다.


### 3. 프록시
: 인터넷 상의 여러 네트워크들에 접속할 때 중계 역할을 해주는 프로그램 or 컴퓨터    

프록시는 요청을 가로챈 뒤 응답을 되돌려준다.  
아래와 같은 다양한 기능들을 수행함.  
1. 캐싱
2. 필터링
3. 로드 밸런싱 (여러 서버들이 서로 다른 요청을 처리하도록 허용)
4. 인증 (다양한 리소스에 대한 접근 제어)
5. 로깅 (이력 정보를 저장)  

* **forward proxy** 인터넷 상에서 어디로든지 요청을 전송해주는 프록시  
* **reverse proxy** 인터넷에서 요청을 받으면, 내부망 내의 서버로 전송  



---
> 짧은 정리. 
* 서비스가 뭔데? 컴퓨터 리소스의 추상화.  
* API? 서비스에 액세스하기 위한 추상화 계층.  



---

---
## HTTP은 상태는 없지만 세션은 있다.  
* **stateless** : 상태를 저장하지 않는다. 
	* 동일한 연결 상에서 연속하여 전달된 두 개의 요청 사이에는 연결고리가 없다.  
	* (이커머스 쇼핑 바구니같이 일관된 방식으로 사용자가 페이지와 상호작용하길 원할 때 문제가 된다.)
* **Cookie** : 세션을 만들도록 해준다.  
	* 헤더 확장성을 사용하여 동일한 컨텍스트 또는 동일한 상태를 공유하기 위해 각각의 요청들에 세션을 만들도록 쿠키를 사용한다.  

---
## HTTP 로 제어할 수 있는 것
* 캐시
	* HTTP로 문서가 캐시되는 방식을 제어할 수 있음.  
	* 서버는 **캐시 대상**과 **기간**을 프록시와 클라이언트에 지시할 수 있다.  
	* 클라이언트는 저장된 문서를 무시하라고 중간 캐시 프록시에게 지시할 수 있다.  
* `origin` 제약사항 완화하기
	* 스누핑과 다른 프라이버시 침해를 막기 위해, 브라우저는 웹 사이트 간의 엄격한 분리를 강제한다.  
	* 동일한 origin으로부터 온 페이지만이 웹 페이지의 전체 정보에 접근할 수 있다.  
* 인증
	* [HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)를 통해 특정 세션을 설정할 수 있다.  
* 프록시와 터널링
* 세션
	* [쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies) 사용은 서버 상태를 요청과 연결하도록 해준다.
	* 기본적으로 stateless 프로토콜임에도 세션을 만들어주는 계기가 된다.  

---

## HTTP 메시지
1. 요청 메시지
2. 응답 메시지

### 요청
```
GET / HTTP/1.1
HOST: developer.mozilla.org
Accept-Language: fr
```
* HTTP methods 
	* 보통 클라이언트가 수행하고자 하는 동작을 정의한 명사.
		`GET, POST, OPTIONS, HEAD`
* 가져오려는 리소스의 경로; 프로토콜(`http://`), 도메인, TCP port를 제거한 리소스의 URL
* HTTP 프로토콜 버젼
* 서버에 대한 추가 정보를 전달하는 선택적 헤더들  
* POST와 같은 몇 가지 메서드들을 위한, 전송된 리소스를 포함하는 응답의 본문과 유사한 본문.  

### 응답
```
HTTP/1.1 200 OK
Date: Sat, 09 Oct 2023 12:37:02 GMT
Server: Apache
Last-Modified: Tue, 01 Dec 
ETage: "5112315-b23-sd34"
Accapet-Ranges: bytes
Content-Length: 29854
Content-Type: text/html
```
* HTTp 프로토콜의 버전
* 요청의 성공 여부와, 상태 코드 (status code)
* 상태 코드의 짧은 설명을 나타내는 상태 메시지 (status message)
* 요청 헤더와 비슷한 HTTP 헤더들
* 선택 사항으로 가져온 리소스가 포함되는 본문


## HTTP 기반 API
* XMLHttpRequest
* Fetch API
