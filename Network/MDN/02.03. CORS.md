# CORS 교차 출처 리소스 공유

## 웹 보안의 기본 원칙 중 하나 : 브라우저의 동일 출처 정책 (Same-Origin Policy)
원래 웹은 다른 프로토콜, 도메인, 포트에서 작동하는 서버로 HTTP 요청을 보내지 못하게 하는 보안 매커니즘이 있다.  
이유는, 사용자 데이터를 악의적인 스크립트로부터 보호하기 위함임!  

그러나 현대 웹 앱에서는 종종 여러 도메인 간에 리소스를 공유해야 하는 경우가 많다.  
이때 필요한 것이 바로...  
## CORS (Cross-Origin Resource Sharing)
**HTTP 헤더**를 사용하여 **A 출처**에서 실행 중인 웹 앱이 **다른 B 출처**의 **자원에 접근할 수 있는 권한을 부여**하도록 브라우저에게 알려주는 체제.
웹 앱은 리소스가 자신의 출처(스킴(프로토콜), 호스트(도메인), 포트)와 다른 출처 HTTP 요청을 실행한다.

## 어떤 요청이 CORS를 사용하나?
아래와 같은 경우 사이트간 HTTP 요청을 허용한다.  

* HXMLHttpRequest, Fetch API call
* 웹 폰트 (@font-face에서 교차 도메인 폰트 사용 시)
* WebGL 텍스쳐
* drawImage() 사용하여 캔버스에 그린 이미지/비디오 프레임
* CSS Shapes

## 언제 CORS 에러가 발생하나요?
서버 측에서 올바르게 CORS 설정이 되어 있지 않다면 클라이언트 측에서 'CORS 에러'가 발생한다.  
이런 경우 서버 응답 헤더에 Access-Control-Allow-Origin 등의 설정을 추가하여 해결할 수 있다.  

## 나는 어떻게 해결했나요?
포켓몬 api 사용 시 CORS 에러가 떴다. 
axios에서 프록시 서버 설정해서 CORS에러를 우회하는 방식으로 해결하였다.  

어쨋거나 CORS 에러라는 것은 브라우저 정책인 것이며, (프록시)서버와 (요청을 받은)서버 간의 통신에서는 동일 출처 정책이 적용되지 않는다.  
또 클라이언트와 프록시 서버는 동일 출처이니 "클라이언트-서버 통신"을 "클라이언트와 출처가 동일한 중개 역할을 하는 프록시 서버-서버 통신"으로 대신하는 것.

---

* 예를 들면, 도메인 A(`http://domaina.example/`)의 HTML 페이지가 `img` 요소를 통해 도메인 B(`http://domainb.foo/image.jpg`)의 이미지에 대한 요청을 생성하는 것입니다. 
* 오늘날의 웹 페이지가 CSS 스타일시트, 이미지, 스크립트 등을 포함하는 교차-사이트 리소스을 로드하는 것을 아주 흔하게 볼 수 있습니다. 
* CORS를 통해 웹 개발자는 그들의 사이트가 교차-사이트 요청에 대해 어떻게 반응할지 제어할 수 있습니다.